<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 850 550">
  <defs>
    <marker id="arrow" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#60a5fa"/>
    </marker>
  </defs>
  
  <!-- Background -->
  <rect width="850" height="550" fill="#0f172a" rx="12"/>
  
  <!-- Title -->
  <text x="425" y="35" text-anchor="middle" font-family="Arial, sans-serif" font-size="22" font-weight="bold" fill="#f8fafc">YOLOv3/v4 ARCHITECTURE</text>
  
  <!-- Input -->
  <g transform="translate(350, 65)">
    <rect width="150" height="45" rx="8" fill="#1e293b" stroke="#3b82f6" stroke-width="2"/>
    <text x="75" y="20" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#60a5fa">Input</text>
    <text x="75" y="38" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#93c5fd">416×416×3</text>
  </g>
  
  <line x1="425" y1="115" x2="425" y2="135" stroke="#60a5fa" stroke-width="2" marker-end="url(#arrow)"/>
  
  <!-- Darknet Backbone -->
  <g transform="translate(300, 140)">
    <rect width="250" height="60" rx="8" fill="#4c1d95" stroke="#8b5cf6" stroke-width="2"/>
    <text x="125" y="25" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#e9d5ff">Darknet-53 Backbone</text>
    <text x="125" y="45" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#c4b5fd">Feature Extraction</text>
  </g>
  
  <!-- Branch lines -->
  <line x1="425" y1="205" x2="425" y2="225" stroke="#60a5fa" stroke-width="2"/>
  <line x1="150" y1="225" x2="700" y2="225" stroke="#60a5fa" stroke-width="2"/>
  <line x1="150" y1="225" x2="150" y2="250" stroke="#60a5fa" stroke-width="2" marker-end="url(#arrow)"/>
  <line x1="425" y1="225" x2="425" y2="250" stroke="#60a5fa" stroke-width="2" marker-end="url(#arrow)"/>
  <line x1="700" y1="225" x2="700" y2="250" stroke="#60a5fa" stroke-width="2" marker-end="url(#arrow)"/>
  
  <!-- Scale 1: 52×52 (Small objects) -->
  <g transform="translate(80, 255)">
    <rect width="140" height="80" rx="8" fill="#1e293b" stroke="#22c55e" stroke-width="2"/>
    <text x="70" y="25" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#4ade80">52×52</text>
    <text x="70" y="45" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#6ee7b7">Scale 1</text>
    <text x="70" y="65" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#86efac">Small objects</text>
  </g>
  
  <!-- Scale 2: 26×26 (Medium objects) -->
  <g transform="translate(355, 255)">
    <rect width="140" height="80" rx="8" fill="#1e293b" stroke="#f59e0b" stroke-width="2"/>
    <text x="70" y="25" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#fbbf24">26×26</text>
    <text x="70" y="45" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#fcd34d">Scale 2</text>
    <text x="70" y="65" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#fef3c7">Medium objects</text>
  </g>
  
  <!-- Scale 3: 13×13 (Large objects) -->
  <g transform="translate(630, 255)">
    <rect width="140" height="80" rx="8" fill="#1e293b" stroke="#ef4444" stroke-width="2"/>
    <text x="70" y="25" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#f87171">13×13</text>
    <text x="70" y="45" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#fca5a5">Scale 3</text>
    <text x="70" y="65" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#fecaca">Large objects</text>
  </g>
  
  <!-- Detection Heads -->
  <line x1="150" y1="340" x2="150" y2="360" stroke="#60a5fa" stroke-width="2" marker-end="url(#arrow)"/>
  <line x1="425" y1="340" x2="425" y2="360" stroke="#60a5fa" stroke-width="2" marker-end="url(#arrow)"/>
  <line x1="700" y1="340" x2="700" y2="360" stroke="#60a5fa" stroke-width="2" marker-end="url(#arrow)"/>
  
  <g transform="translate(80, 365)">
    <rect width="140" height="35" rx="6" fill="#14532d" stroke="#22c55e" stroke-width="1"/>
    <text x="70" y="22" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#4ade80">Detection Head</text>
  </g>
  <g transform="translate(355, 365)">
    <rect width="140" height="35" rx="6" fill="#422006" stroke="#f59e0b" stroke-width="1"/>
    <text x="70" y="22" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#fbbf24">Detection Head</text>
  </g>
  <g transform="translate(630, 365)">
    <rect width="140" height="35" rx="6" fill="#7f1d1d" stroke="#ef4444" stroke-width="1"/>
    <text x="70" y="22" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#f87171">Detection Head</text>
  </g>
  
  <!-- Merge and NMS -->
  <line x1="150" y1="405" x2="700" y2="405" stroke="#60a5fa" stroke-width="2"/>
  <line x1="425" y1="405" x2="425" y2="430" stroke="#60a5fa" stroke-width="2" marker-end="url(#arrow)"/>
  
  <g transform="translate(325, 435)">
    <rect width="200" height="40" rx="6" fill="#1e293b" stroke="#ec4899" stroke-width="2"/>
    <text x="100" y="25" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#f472b6">NMS → Output</text>
  </g>
  
  <!-- Grid cell prediction box -->
  <g transform="translate(50, 420)">
    <rect width="220" height="110" rx="8" fill="#1e293b" stroke="#6366f1" stroke-width="2"/>
    <text x="110" y="20" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#818cf8">Grid Cell Prediction</text>
    <text x="20" y="42" font-family="Arial, sans-serif" font-size="9" fill="#c4b5fd">bx = σ(tx) + cx</text>
    <text x="20" y="58" font-family="Arial, sans-serif" font-size="9" fill="#c4b5fd">by = σ(ty) + cy</text>
    <text x="20" y="74" font-family="Arial, sans-serif" font-size="9" fill="#c4b5fd">bw = pw × e^tw</text>
    <text x="20" y="90" font-family="Arial, sans-serif" font-size="9" fill="#c4b5fd">bh = ph × e^th</text>
    <text x="20" y="105" font-family="Arial, sans-serif" font-size="8" fill="#94a3b8">(cx,cy)=offset, (pw,ph)=anchor</text>
  </g>
</svg>
