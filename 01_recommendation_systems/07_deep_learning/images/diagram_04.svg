<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 480">
  <defs>
    <linearGradient id="bgSAS" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#0f172a"/>
      <stop offset="100%" style="stop-color:#1e293b"/>
    </linearGradient>
    <linearGradient id="attGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#f59e0b"/>
      <stop offset="100%" style="stop-color:#d97706"/>
    </linearGradient>
    <filter id="shadowSAS" x="-10%" y="-10%" width="120%" height="130%">
      <feDropShadow dx="0" dy="4" stdDeviation="6" flood-opacity="0.3"/>
    </filter>
    <marker id="arrowSAS" markerWidth="10" markerHeight="10" refX="9" refY="5" orient="auto">
      <path d="M0,0 L10,5 L0,10 L3,5 Z" fill="#f59e0b"/>
    </marker>
  </defs>
  
  <rect width="100%" height="100%" fill="url(#bgSAS)"/>
  
  <!-- Title -->
  <text x="450" y="40" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="24" font-weight="bold" fill="#f8fafc">üîÆ SASRec: Self-Attentive Sequential Recommendation</text>
  
  <!-- User History -->
  <g transform="translate(100, 70)">
    <rect width="700" height="50" rx="10" fill="#334155"/>
    <text x="350" y="32" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="13" fill="#f8fafc">User History: [Item1, Item2, Item3, Item4, Item5]</text>
  </g>
  
  <!-- Arrows down -->
  <path d="M450 125 L450 155" stroke="#64748b" stroke-width="2" marker-end="url(#arrowSAS)"/>
  
  <!-- Self-Attention Layer -->
  <g transform="translate(100, 160)" filter="url(#shadowSAS)">
    <rect width="700" height="160" rx="14" fill="#1e293b"/>
    <rect width="700" height="50" rx="14 14 0 0" fill="url(#attGrad)"/>
    <text x="350" y="32" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="15" font-weight="bold" fill="#f8fafc">‚ö° Self-Attention Layer</text>
    
    <g transform="translate(30, 70)">
      <!-- Q, K, V -->
      <rect x="0" y="0" width="200" height="35" rx="6" fill="#f59e0b" opacity="0.2"/>
      <text x="100" y="23" text-anchor="middle" font-family="Segoe UI, monospace" font-size="12" fill="#fcd34d">Q = XW_q   K = XW_k   V = XW_v</text>
      
      <!-- Attention formula -->
      <rect x="220" y="0" width="440" height="35" rx="6" fill="#334155"/>
      <text x="440" y="23" text-anchor="middle" font-family="Segoe UI, monospace" font-size="12" fill="#f8fafc">Attention(Q,K,V) = softmax(QK<tspan baseline-shift="super" font-size="9">T</tspan> / ‚àöd) √ó V</text>
      
      <!-- Causal mask note -->
      <rect x="150" y="50" width="340" height="30" rx="6" fill="#ef4444" opacity="0.15"/>
      <text x="320" y="70" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="11" fill="#fca5a5">‚ö†Ô∏è With CAUSAL MASK (can only attend to past items)</text>
    </g>
  </g>
  
  <!-- Arrow down -->
  <path d="M450 325 L450 355" stroke="#64748b" stroke-width="2" marker-end="url(#arrowSAS)"/>
  
  <!-- Feed-Forward Network -->
  <g transform="translate(200, 360)" filter="url(#shadowSAS)">
    <rect width="500" height="50" rx="12" fill="#8b5cf6"/>
    <text x="250" y="32" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="14" font-weight="bold" fill="#f8fafc">Feed-Forward Network (FFN)</text>
  </g>
  
  <!-- Arrow down -->
  <path d="M450 415 L450 445" stroke="#64748b" stroke-width="2" marker-end="url(#arrowSAS)"/>
  
  <!-- Prediction Layer -->
  <g transform="translate(300, 450)" filter="url(#shadowSAS)">
    <rect width="300" height="45" rx="22" fill="#10b981"/>
    <text x="150" y="28" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="14" font-weight="bold" fill="#f8fafc">üéØ Prediction Layer</text>
  </g>
  
  <!-- Side notes -->
  <g transform="translate(50, 360)">
    <rect width="130" height="90" rx="10" fill="#334155"/>
    <text x="65" y="20" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="10" font-weight="bold" fill="#f8fafc">‚ú® Benefits</text>
    <text x="65" y="40" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="9" fill="#94a3b8">‚Ä¢ Long-range deps</text>
    <text x="65" y="55" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="9" fill="#94a3b8">‚Ä¢ Parallelizable</text>
    <text x="65" y="70" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="9" fill="#94a3b8">‚Ä¢ Position-aware</text>
  </g>
  
  <g transform="translate(720, 360)">
    <rect width="130" height="90" rx="10" fill="#334155"/>
    <text x="65" y="20" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="10" font-weight="bold" fill="#f8fafc">üìä Results</text>
    <text x="65" y="40" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="9" fill="#94a3b8">‚Ä¢ Beats GRU4Rec</text>
    <text x="65" y="55" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="9" fill="#94a3b8">‚Ä¢ Faster training</text>
    <text x="65" y="70" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="9" fill="#94a3b8">‚Ä¢ SOTA on ML-1M</text>
  </g>
</svg>
