<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 550">
  <defs>
    <linearGradient id="bgTT" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#0f172a"/>
      <stop offset="100%" style="stop-color:#1e293b"/>
    </linearGradient>
    <linearGradient id="userTowerGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#3b82f6"/>
      <stop offset="100%" style="stop-color:#1d4ed8"/>
    </linearGradient>
    <linearGradient id="itemTowerGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#10b981"/>
      <stop offset="100%" style="stop-color:#059669"/>
    </linearGradient>
    <filter id="shadowTT" x="-10%" y="-10%" width="120%" height="130%">
      <feDropShadow dx="0" dy="4" stdDeviation="6" flood-opacity="0.3"/>
    </filter>
    <marker id="arrowTT" markerWidth="10" markerHeight="10" refX="9" refY="5" orient="auto">
      <path d="M0,0 L10,5 L0,10 L3,5 Z" fill="#f59e0b"/>
    </marker>
  </defs>
  
  <rect width="100%" height="100%" fill="url(#bgTT)"/>
  
  <!-- Title -->
  <text x="450" y="40" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="24" font-weight="bold" fill="#f8fafc">ğŸ›ï¸ Two-Tower Architecture</text>
  
  <!-- User Tower -->
  <g transform="translate(100, 80)" filter="url(#shadowTT)">
    <rect width="280" height="320" rx="14" fill="#1e293b"/>
    <rect width="280" height="50" rx="14 14 0 0" fill="url(#userTowerGrad)"/>
    <text x="140" y="32" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="15" font-weight="bold" fill="#f8fafc">ğŸ‘¤ USER TOWER</text>
    
    <!-- User Features -->
    <g transform="translate(20, 65)">
      <rect x="0" y="0" width="240" height="80" rx="10" fill="#334155"/>
      <text x="120" y="18" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="11" font-weight="bold" fill="#f8fafc">User Features</text>
      <text x="120" y="38" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="10" fill="#60a5fa">â€¢ Watch/browse history</text>
      <text x="120" y="53" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="10" fill="#60a5fa">â€¢ Demographics</text>
      <text x="120" y="68" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="10" fill="#60a5fa">â€¢ Context (time, device)</text>
    </g>
    
    <!-- Arrow -->
    <text x="140" y="155" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="16" fill="#64748b">â†“</text>
    
    <!-- DNN -->
    <g transform="translate(20, 165)">
      <rect x="0" y="0" width="240" height="50" rx="10" fill="#3b82f6"/>
      <text x="120" y="32" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="12" font-weight="bold" fill="#f8fafc">DNN Layers</text>
    </g>
    
    <!-- Arrow -->
    <text x="140" y="230" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="16" fill="#64748b">â†“</text>
    
    <!-- User Embedding -->
    <g transform="translate(20, 240)">
      <rect x="0" y="0" width="240" height="60" rx="10" fill="#1d4ed8"/>
      <text x="120" y="25" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="12" font-weight="bold" fill="#f8fafc">User Embedding</text>
      <text x="120" y="45" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="11" fill="#bfdbfe">(128-D vector)</text>
    </g>
  </g>
  
  <!-- Item Tower -->
  <g transform="translate(520, 80)" filter="url(#shadowTT)">
    <rect width="280" height="320" rx="14" fill="#1e293b"/>
    <rect width="280" height="50" rx="14 14 0 0" fill="url(#itemTowerGrad)"/>
    <text x="140" y="32" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="15" font-weight="bold" fill="#f8fafc">ğŸ“¦ ITEM TOWER</text>
    
    <!-- Item Features -->
    <g transform="translate(20, 65)">
      <rect x="0" y="0" width="240" height="80" rx="10" fill="#334155"/>
      <text x="120" y="18" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="11" font-weight="bold" fill="#f8fafc">Item Features</text>
      <text x="120" y="38" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="10" fill="#6ee7b7">â€¢ Content (title, desc)</text>
      <text x="120" y="53" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="10" fill="#6ee7b7">â€¢ Metadata (category)</text>
      <text x="120" y="68" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="10" fill="#6ee7b7">â€¢ Stats (popularity)</text>
    </g>
    
    <!-- Arrow -->
    <text x="140" y="155" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="16" fill="#64748b">â†“</text>
    
    <!-- DNN -->
    <g transform="translate(20, 165)">
      <rect x="0" y="0" width="240" height="50" rx="10" fill="#10b981"/>
      <text x="120" y="32" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="12" font-weight="bold" fill="#f8fafc">DNN Layers</text>
    </g>
    
    <!-- Arrow -->
    <text x="140" y="230" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="16" fill="#64748b">â†“</text>
    
    <!-- Item Embedding -->
    <g transform="translate(20, 240)">
      <rect x="0" y="0" width="240" height="60" rx="10" fill="#059669"/>
      <text x="120" y="25" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="12" font-weight="bold" fill="#f8fafc">Item Embedding</text>
      <text x="120" y="45" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="11" fill="#a7f3d0">(128-D vector)</text>
    </g>
  </g>
  
  <!-- Merge lines -->
  <path d="M260 380 L260 430 L450 430 L450 460" stroke="#f59e0b" stroke-width="3"/>
  <path d="M640 380 L640 430 L450 430" stroke="#f59e0b" stroke-width="3"/>
  
  <!-- Dot Product -->
  <g transform="translate(350, 420)" filter="url(#shadowTT)">
    <rect width="200" height="50" rx="25" fill="#f59e0b"/>
    <text x="100" y="32" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="14" font-weight="bold" fill="#f8fafc">âš¡ Dot Product</text>
  </g>
  
  <!-- Result -->
  <g transform="translate(350, 490)" filter="url(#shadowTT)">
    <rect width="200" height="45" rx="22" fill="#8b5cf6"/>
    <text x="100" y="28" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="13" font-weight="bold" fill="#f8fafc">ğŸ¯ Relevance Score</text>
  </g>
  
  <!-- Serving Note -->
  <g transform="translate(100, 460)">
    <rect width="200" height="65" rx="10" fill="#334155"/>
    <text x="100" y="22" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="11" font-weight="bold" fill="#f8fafc">ğŸš€ Serving</text>
    <text x="100" y="40" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="9" fill="#94a3b8">Pre-compute item embeddings</text>
    <text x="100" y="55" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="9" fill="#94a3b8">Use ANN for fast retrieval</text>
  </g>
  
  <g transform="translate(600, 460)">
    <rect width="200" height="65" rx="10" fill="#334155"/>
    <text x="100" y="22" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="11" font-weight="bold" fill="#f8fafc">ğŸ“Š Used By</text>
    <text x="100" y="40" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="9" fill="#94a3b8">YouTube, Pinterest, Uber</text>
    <text x="100" y="55" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="9" fill="#94a3b8">Scale: Billions of items</text>
  </g>
</svg>
