<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 850 450">
  <defs>
    <linearGradient id="l1Grad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#ef4444"/>
      <stop offset="100%" style="stop-color:#dc2626"/>
    </linearGradient>
    <linearGradient id="l2Grad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#f59e0b"/>
      <stop offset="100%" style="stop-color:#d97706"/>
    </linearGradient>
    <linearGradient id="l3Grad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#10b981"/>
      <stop offset="100%" style="stop-color:#059669"/>
    </linearGradient>
    <linearGradient id="dbGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#3b82f6"/>
      <stop offset="100%" style="stop-color:#2563eb"/>
    </linearGradient>
    <filter id="shadow" x="-5%" y="-5%" width="110%" height="115%">
      <feDropShadow dx="0" dy="3" stdDeviation="4" flood-opacity="0.15"/>
    </filter>
    <marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="5" orient="auto">
      <path d="M0,0 L10,5 L0,10 L3,5 Z" fill="#64748b"/>
    </marker>
  </defs>
  
  <rect width="100%" height="100%" fill="#0f172a"/>
  
  <!-- Title -->
  <text x="425" y="35" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="22" font-weight="bold" fill="#f8fafc">ğŸ—„ï¸ ML Serving Cache Hierarchy</text>
  
  <!-- Request -->
  <g filter="url(#shadow)">
    <rect x="50" y="180" width="100" height="80" rx="12" fill="#334155"/>
    <text x="100" y="210" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="12" fill="#f8fafc">ğŸ‘¤ Request</text>
    <text x="100" y="240" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="10" fill="#94a3b8">user_id: 123</text>
  </g>
  
  <!-- Arrow -->
  <path d="M155 220 L190 220" stroke="#64748b" stroke-width="2" marker-end="url(#arrow)"/>
  
  <!-- L1 Cache - Response Cache -->
  <g filter="url(#shadow)">
    <rect x="200" y="100" width="160" height="240" rx="14" fill="#1e293b"/>
    <rect x="200" y="100" width="160" height="45" rx="14 14 0 0" fill="url(#l1Grad)"/>
    <text x="280" y="130" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="14" font-weight="bold" fill="#f8fafc">L1: Response</text>
    
    <text x="280" y="165" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="11" fill="#fca5a5">Exact prediction cache</text>
    
    <rect x="215" y="180" width="130" height="60" rx="8" fill="#450a0a"/>
    <text x="280" y="200" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="9" fill="#fecaca">Latency: ~1ms</text>
    <text x="280" y="218" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="9" fill="#fecaca">Hit rate: 5-30%</text>
    <text x="280" y="236" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="9" fill="#fecaca">TTL: 5-60 min</text>
    
    <text x="280" y="270" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="10" fill="#94a3b8">Store:</text>
    <text x="280" y="290" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="10" fill="#fca5a5">Local memory, Redis</text>
    
    <text x="280" y="320" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="9" fill="#64748b">key=hash(input)</text>
  </g>
  
  <!-- Arrow -->
  <path d="M365 220 L400 220" stroke="#64748b" stroke-width="2" marker-end="url(#arrow)"/>
  <text x="382" y="210" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="8" fill="#64748b">miss</text>
  
  <!-- L2 Cache - Feature Cache -->
  <g filter="url(#shadow)">
    <rect x="410" y="100" width="160" height="240" rx="14" fill="#1e293b"/>
    <rect x="410" y="100" width="160" height="45" rx="14 14 0 0" fill="url(#l2Grad)"/>
    <text x="490" y="130" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="14" font-weight="bold" fill="#f8fafc">L2: Features</text>
    
    <text x="490" y="165" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="11" fill="#fcd34d">Pre-computed features</text>
    
    <rect x="425" y="180" width="130" height="60" rx="8" fill="#78350f"/>
    <text x="490" y="200" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="9" fill="#fef3c7">Latency: ~5ms</text>
    <text x="490" y="218" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="9" fill="#fef3c7">Hit rate: 80-95%</text>
    <text x="490" y="236" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="9" fill="#fef3c7">TTL: 1-24 hours</text>
    
    <text x="490" y="270" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="10" fill="#94a3b8">Store:</text>
    <text x="490" y="290" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="10" fill="#fcd34d">Feature Store, Redis</text>
    
    <text x="490" y="320" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="9" fill="#64748b">key=entity_id</text>
  </g>
  
  <!-- Arrow -->
  <path d="M575 220 L610 220" stroke="#64748b" stroke-width="2" marker-end="url(#arrow)"/>
  <text x="592" y="210" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="8" fill="#64748b">miss</text>
  
  <!-- L3 - Model Inference -->
  <g filter="url(#shadow)">
    <rect x="620" y="100" width="160" height="240" rx="14" fill="#1e293b"/>
    <rect x="620" y="100" width="160" height="45" rx="14 14 0 0" fill="url(#l3Grad)"/>
    <text x="700" y="130" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="14" font-weight="bold" fill="#f8fafc">L3: Model</text>
    
    <text x="700" y="165" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="11" fill="#6ee7b7">Full inference</text>
    
    <rect x="635" y="180" width="130" height="60" rx="8" fill="#064e3b"/>
    <text x="700" y="200" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="9" fill="#a7f3d0">Latency: 50-200ms</text>
    <text x="700" y="218" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="9" fill="#a7f3d0">Always computed</text>
    <text x="700" y="236" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="9" fill="#a7f3d0">Results cached</text>
    
    <text x="700" y="270" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="10" fill="#94a3b8">Compute:</text>
    <text x="700" y="290" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="10" fill="#6ee7b7">GPU/CPU inference</text>
    
    <text x="700" y="320" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="9" fill="#64748b">Fresh prediction</text>
  </g>
  
  <!-- Response arrows back -->
  <path d="M700 345 L700 380 L100 380 L100 265" stroke="#6ee7b7" stroke-width="2" stroke-dasharray="5,3"/>
  <polygon points="95,265 100,250 105,265" fill="#6ee7b7"/>
  
  <!-- Legend -->
  <g transform="translate(200, 400)">
    <rect x="0" y="0" width="450" height="40" rx="8" fill="#1e293b"/>
    <text x="225" y="28" text-anchor="middle" font-family="Segoe UI, sans-serif" font-size="11" fill="#94a3b8">ğŸ’¡ Check L1 â†’ L2 â†’ L3 in order. Cache results at each level for future requests.</text>
  </g>
</svg>
